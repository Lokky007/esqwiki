{% extends 'base.html' %}
{% load staticfiles %}
{% load filters %}

{% block content %}
    <div class="d-inline-block margin-bottom-20 forum_navbar" >
        <span>></span>
        <a href="{% url 'main_forum' %}">Hlavní stránka fóra</a>
        <span>></span>
        <a href="{% url 'topic_overview' id_category=id_category%}">Přehled vláken v kategorii</a>
    </div>

    {% if topic_data %}

        {% for topic in topic_data %}
            <div class="padding_bottom_10">
                <span class="topic_header">
                        {{ topic.name }}
                </span>
            </div>

            <div class="topic_category_block">
                {{ topic.text }}
            </div>
        {% endfor %}

        <hr>

        {% if answer_data %}
            {% for answer in answer_data %}
                <div class="topic_category_block">
                    {{ answer.text }}
                    <div class="float-right">
                        <span>{{ answer.x_user.username }}</span>
                        <span>{{ answer.x_created|date:'H:i j.n Y' }}</span>
                    </div>
                    <div>
                       {{ window_html }}
                        <a href="{% url 'delete_answer' id_answer=answer.id_answer %}">Smazat</a>
                        <a onclick="show_reaction_form({{answer.id_answer}})">Reagovat</a>
                    </div>
                </div>
                <!-- reaction -->
                <div id="reaction_form_{{answer.id_answer}}" style="display: None;">
                      <form action="{% url 'new_reaction' id_answer=answer.id_answer%}" method="post">
                          <input type="hidden" name="csrfmiddlewaretoken" value="{{ addition_csrf_token }}">
                            {% csrf_token %}
                          {{ new_reaction_form }}
                          <button type="submit" class="save btn btn-default">Odeslat</button>
                     </form>
                </div>
            {% endfor %}


        {% endif %}
    {% endif %}

    <button onclick="show_form()">Odpověd</button>

    <div id="answer_form" style="display: None;">
          <form action="{% url 'new_answer' id_category=id_category id_topic=id_topic %}" method="post" >
             {% csrf_token %}
            {{ new_answer_post }}
            <button type="submit" class="save btn btn-default">Odeslat</button>
          </form>
    </div>

    <script>
        function show_form()
        {
            var x = document.getElementById("answer_form");
              if (x.style.display === "none") {
                x.style.display = "block";
              } else {
                x.style.display = "none";
              }
        }

        function show_reaction_form(id)
        {
            var x = document.getElementById("reaction_form_"+id);
              if (x.style.display === "none") {
                x.style.display = "block";
              } else {
                x.style.display = "none";
              }
        }



    </script>

{% endblock %}